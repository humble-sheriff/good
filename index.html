<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cute Cat Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff7fb;
      text-align: center;
      padding: 40px;
      transition: background 0.4s, color 0.4s;
    }
    body.dark {
      background: #1e1e1e;
      color: #eee;
    }
    h1 {
      color: #ff66aa;
    }
    button {
      background: #ff66aa;
      color: white;
      padding: 10px 16px;
      margin: 6px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #ff3388;
    }
    img {
      margin-top: 20px;
      max-width: 80%;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    #gallery {
      margin-top: 40px;
    }
    .gallery-img {
      width: 150px;
      margin: 8px;
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }
    #quote, #fact {
      margin-top: 15px;
      font-style: italic;
      color: #555;
    }
    body.dark #quote, body.dark #fact {
      color: #ddd;
    }
  </style>
</head>
<body>
  <h1>🐱 Cute Cat Generator 🐾</h1>
  <button onclick="generateCat()">New Cat 😻</button>
  <button onclick="likeCat()">❤️ Like</button>
  <button onclick="toggleSurprise()">🎲 Surprise Mode</button>
  <button onclick="toggleAuto()">⏳ Auto Refresh</button>
  <button onclick="clearLiked()">🗑️ Clear Liked</button>
  <button onclick="shuffleLiked()">🔀 Shuffle Liked</button>
  <button onclick="toggleDarkMode()">🌙 Dark/Light</button>

  <div>
    <img id="catImage" src="" alt="Your cat will appear here!">
    <p id="quote"></p>
    <p id="fact"></p>
  </div>

  <div id="gallery">
    <h2>❤️ Your Liked Cats</h2>
    <div id="likedCats"></div>
  </div>

  <script>
    const GEMINI_KEY = "AIzaSyCQyNfJRifhZe2f3kL2UJXxTOcazIBUqnc"; // replace with your Gemini key
    let currentCatUrl = "";
    let surpriseMode = false;
    let autoRefresh = null;

    const loadingMessages = [
      "🐾 Chasing cats...",
      "😺 Petting whiskers...",
      "🐱 Meow-tastic loading...",
      "😻 Cuteness incoming...",
      "🐈 Rolling in catnip..."
    ];

    async function generateCat() {
      const imgElement = document.getElementById("catImage");
      const quoteElement = document.getElementById("quote");
      const factElement = document.getElementById("fact");
      imgElement.alt = loadingMessages[Math.floor(Math.random() * loadingMessages.length)];
      currentCatUrl = "";
      quoteElement.textContent = "";
      factElement.textContent = "";

      // 🎲 Surprise mode expansion
      if (surpriseMode && Math.random() < 0.3) {
        const funnyStuff = [
          // 🐱 Cat memes & pics
          "https://i.imgur.com/JqEuJ6t.jpeg",
          "https://i.imgur.com/z4d4kWk.jpeg",
          "https://i.imgur.com/mE3n3aI.jpeg",
          "https://i.imgur.com/1X5cD8M.jpeg",

          // 🐶 Funny dogs
          "https://i.imgur.com/fvVZq0T.jpeg",
          "https://i.imgur.com/ajL6A7P.jpeg",

          // 🎞️ Cat GIFs
          "https://i.imgur.com/n8OYCzR.gif",
          "https://i.imgur.com/5R6P2MZ.gif",
          "https://i.imgur.com/jSB3cTG.gif",

          // 💬 Cute/funny quotes
          "QUOTE::😺 'Time spent with cats is never wasted.'",
          "QUOTE::🐾 'In ancient times cats were worshipped as gods; they have not forgotten this.'",
          "QUOTE::😹 'Dogs have owners, cats have staff.'"
        ];

        const choice = funnyStuff[Math.floor(Math.random() * funnyStuff.length)];

        if (choice.startsWith("QUOTE::")) {
          imgElement.src = "";
          imgElement.style.display = "none";
          quoteElement.textContent = choice.replace("QUOTE::", "");
        } else {
          currentCatUrl = choice;
          imgElement.src = choice;
          imgElement.alt = "🎲 Surprise!";
          imgElement.style.display = "block";
        }
        return;
      }

      try {
        // Try Gemini for a cat photo URL
        const geminiRes = await fetch(
          "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=" + GEMINI_KEY,
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [{ parts: [{ text: "Give me a direct link to a random cute cat photo." }] }]
            })
          }
        );
        const data = await geminiRes.json();
        const text = data?.candidates?.[0]?.content?.parts?.[0]?.text || "";
        const urlMatch = text.match(/(https?:\/\/\S+\.(jpg|jpeg|png|gif))/i);

        if (urlMatch) {
          currentCatUrl = urlMatch[0];
          imgElement.src = currentCatUrl;
          imgElement.alt = "Cute cat!";
          fetchFact();
          return;
        }
      } catch (e) {
        console.error("Gemini failed", e);
      }

      // 🔄 Fallback: TheCatAPI
      try {
        const fallbackRes = await fetch("https://api.thecatapi.com/v1/images/search");
        const fallbackData = await fallbackRes.json();
        currentCatUrl = fallbackData[0].url;
        imgElement.src = currentCatUrl;
        imgElement.alt = "Cute fallback cat!";
        fetchFact();
      } catch (e) {
        imgElement.alt = "❌ Could not load cat.";
      }
    }

    // 🐾 Fetch random cat fact
    async function fetchFact() {
      try {
        const res = await fetch("https://catfact.ninja/fact");
        const data = await res.json();
        document.getElementById("fact").textContent = "📘 " + data.fact;
      } catch {
        document.getElementById("fact").textContent = "";
      }
    }

    // ❤️ Like current cat
    function likeCat() {
      if (!currentCatUrl) return alert("No cat yet! Generate one first 😺");
      const likedCats = document.getElementById("likedCats");
      const img = document.createElement("img");
      img.src = currentCatUrl;
      img.className = "gallery-img";
      likedCats.appendChild(img);
    }

    // 🗑️ Clear liked cats
    function clearLiked() {
      document.getElementById("likedCats").innerHTML = "";
    }

    // 🔀 Shuffle liked cats
    function shuffleLiked() {
      const likedCatsDiv = document.getElementById("likedCats");
      const imgs = Array.from(likedCatsDiv.children);
      likedCatsDiv.innerHTML = "";
      imgs.sort(() => Math.random() - 0.5).forEach(img => likedCatsDiv.appendChild(img));
    }

    // 🎲 Toggle surprise mode
    function toggleSurprise() {
      surpriseMode = !surpriseMode;
      alert("🎲 Surprise mode " + (surpriseMode ? "ON" : "OFF"));
    }

    // ⏳ Auto refresh every 3s
    function toggleAuto() {
      if (autoRefresh) {
        clearInterval(autoRefresh);
        autoRefresh = null;
        alert("⏳ Auto refresh OFF");
      } else {
        autoRefresh = setInterval(generateCat, 3000);
        alert("⏳ Auto refresh ON (every 3s)");
      }
    }

    // 🌙 Dark/light mode
    function toggleDarkMode() {
      document.body.classList.toggle("dark");
    }

    // Load one cat at start
    window.onload = generateCat;
  </script>
</body>
</html>
